syntax = "proto3";

package user;

enum UserType {
  USER_TYPE_B2B = 0;
  USER_TYPE_B2C = 1;
  USER_TYPE_SUB_AGENT = 2;
  USER_TYPE_SUB_USER = 3;
}

enum UserRole {
  ROLE_USER = 0;
  ROLE_ADMIN = 1;
}

message SignupRequest {
  string email = 1;
  string phoneNumber = 2;
  string password = 3;
  string passwordConfirm = 4;
  optional string firstName = 5;
  optional string lastName = 6;
  optional UserType userType = 7;
  optional string companyName = 8;
  optional string companyAddress = 9;
  optional string district = 10;
  optional string city = 11;
  optional string establishedAt = 12;
  optional string tradeLicenseNumber = 13;
  optional string tradeLicenseFileUrl = 14;
  optional string tinNumber = 15;
  optional string tinCertificateUrl = 16;
  optional string nidNumber = 17;
  optional string nidFrontUrl = 18;
  optional string nidBackUrl = 19;
  optional string civilAviationCertUrl = 20;
}

message LoginRequest {
  string email = 1;
  string password = 2;
}

message AuthResponse {
  string accessToken = 1;
  string refreshToken = 2;
}


message RefreshRequest {
  string refreshToken = 1;
}

service UserService {
  rpc Signup(SignupRequest) returns (AuthResponse);
  rpc Login(LoginRequest) returns (AuthResponse);
  rpc Refresh(RefreshRequest) returns (AuthResponse);
}
